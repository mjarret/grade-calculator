function calculateFinalGrade() {
  const studentType = document.getElementById('studentType').value;
  const isGraduate = studentType === 'graduate';

  const unitsClass = [
    document.getElementById('unit1Class').value,
    document.getElementById('unit2Class').value,
    document.getElementById('unit3Class').value,
    document.getElementById('unit4Class').value,
    document.getElementById('unit5Class').value,
  ];

  const unitsFinal = [
    parseFloat(document.getElementById('unit1Final').value) || 0,
    parseFloat(document.getElementById('unit2Final').value) || 0,
    parseFloat(document.getElementById('unit3Final').value) || 0,
    parseFloat(document.getElementById('unit4Final').value) || 0,
    parseFloat(document.getElementById('unit5Final').value) || 0,
  ];

  // Calculate total units passed
  let totalUnitsPassed = 0;
  unitsClass.forEach((performance, index) => {
    if (performance === 'P' && unitsFinal[index] >= 16) {
      totalUnitsPassed++;
    }
  });

  // Get the final exam or project grade
  const projectGradeInput = parseFloat(document.getElementById('projectGrade').value) || 0;
  const finalExamGrade = unitsFinal.reduce((sum, score) => sum + score, 0);
  const totalFinalGrade = isGraduate ? projectGradeInput : finalExamGrade;

  // Determine the course grade based on the syllabus logic
  let finalGrade = 'F';
  if (totalUnitsPassed === 5 && totalFinalGrade >= 95) {
    finalGrade = 'A+';
  } else if (totalUnitsPassed === 5 && totalFinalGrade >= 90) {
    finalGrade = 'A';
  } else if (totalUnitsPassed === 5) {
    finalGrade = 'A-';
  } else if (totalUnitsPassed === 4 && totalFinalGrade >= 70) {
    finalGrade = 'B+';
  } else if (totalUnitsPassed === 4) {
    finalGrade = 'B';
  } else if (totalUnitsPassed === 3 && totalFinalGrade >= 60) {
    finalGrade = 'B-';
  } else if (totalUnitsPassed === 3) {
    finalGrade = 'C';
  }

  // Update the calculated values in the table
  document.getElementById('finalExamGrade').textContent = isGraduate
    ? projectGradeInput
    : finalExamGrade;
  document.getElementById('averageGrade').textContent = finalGrade;
}

// Ensure the function is triggered on input or selection change
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('input, select').forEach(input => {
    input.addEventListener('input', calculateFinalGrade);
    input.addEventListener('change', calculateFinalGrade);
  });
  calculateFinalGrade(); // Initial calculation
});
